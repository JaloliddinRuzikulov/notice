<!DOCTYPE html>
<html>
<head>
    <title>Debug Permissions</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div style="padding: 20px;">
        <h1>Permission Debug</h1>
        <div id="results"></div>
    </div>
    
    <script>
    async function debugPermissions() {
        const results = document.getElementById('results');
        let html = '<h2>API Tests:</h2>';
        
        // Test various endpoints
        const endpoints = [
            '/api/employees',
            '/api/departments', 
            '/api/districts',
            '/api/groups',
            '/api/employees/count'
        ];
        
        for (const endpoint of endpoints) {
            try {
                const response = await fetch(endpoint);
                const contentType = response.headers.get('content-type');
                let data = 'N/A';
                
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                } else {
                    data = await response.text();
                }
                
                html += `
                    <div style="margin: 10px 0; padding: 10px; background: #f5f5f5;">
                        <h3>${endpoint}</h3>
                        <p>Status: ${response.status} ${response.statusText}</p>
                        <p>Type: ${typeof data}</p>
                        <p>Is Array: ${Array.isArray(data)}</p>
                        ${Array.isArray(data) ? `<p>Length: ${data.length}</p>` : ''}
                        <pre style="max-height: 100px; overflow: auto;">${JSON.stringify(data, null, 2).substring(0, 500)}</pre>
                    </div>
                `;
            } catch (error) {
                html += `
                    <div style="margin: 10px 0; padding: 10px; background: #fee;">
                        <h3>${endpoint}</h3>
                        <p style="color: red;">Error: ${error.message}</p>
                    </div>
                `;
            }
        }
        
        results.innerHTML = html;
    }
    
    // Run on load
    debugPermissions();
    </script>
</body>
</html>